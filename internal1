CREATE TABLE EMPLOYEE (
    EMPID INT PRIMARY KEY NOT NULL,
    ENAME VARCHAR(10),
    SALARY INT,
    AGE INT
);

CREATE TABLE DEPARTMENT(
    DEPNO INT PRIMARY KEY NOT NULL,
    DNAME VARCHAR(10),
    MSSN INT
);

ALTER TABLE EMPLOYEE ADD DEPNO INT, ADD FOREIGN KEY (DEPNO) REFERENCES DEPARTMENT(DEPNO);

INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(201, 'HR');
INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(202, 'Finance');
INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(203, 'IT');
INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(204, 'Marketing');
INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(205, 'Sales');
INSERT INTO DEPARTMENT(DEPNO, DNAME) VALUES(206, 'Support');

INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(101, 'ABC', 250000, 25, 201);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(102, 'DEF', 150000, 30, 202);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(103, 'GHI', 50000, 28, 203);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(104, 'JKL', 100000, 35, 204);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(105, 'MNO', 120000, 26, 201);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(106, 'PQR', 90000, 32, 202);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(107, 'STU', 75000, 29, 203);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(108, 'VWX', 110000, 33, 204);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(109, 'YZA', 80000, 27, 205);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(110, 'BCD', 95000, 31, 206);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(111, 'EFG', 115000, 30, 205);
INSERT INTO EMPLOYEE(EMPID, ENAME, SALARY, AGE, DEPNO) VALUES(112, 'HIJ', 98000, 29, 206);

-- SELECT * FROM EMPLOYEE;

-- SELECT
--     EMPLOYEE.ENAME,
--     EMPLOYEE.SALARY,
--     EMPLOYEE.DEPNO,
--     DEPARTMENT.DEPNO,
--     DEPARTMENT.DNAME
-- FROM
--     EMPLOYEE
-- INNER JOIN
--     DEPARTMENT
-- ON
--     EMPLOYEE.DEPNO = DEPARTMENT.DEPNO;

-- SELECT AVG(EMPLOYEE.SALARY) 
-- FROM EMPLOYEE 
-- INNER JOIN DEPARTMENT 
-- ON EMPLOYEE.DEPNO = DEPARTMENT.DEPNO 
-- WHERE DEPARTMENT.DNAME = 'Finance';

-- SELECT
--     DEPARTMENT.DNAME,
--     AVG(EMPLOYEE.SALARY) AS Avg_Salary
-- FROM
--     EMPLOYEE
-- INNER JOIN
--     DEPARTMENT
-- ON
--     EMPLOYEE.DEPNO = DEPARTMENT.DEPNO
-- GROUP BY
--     DEPARTMENT.DNAME;

-- SELECT 
--     d.DNAME AS DepartmentName,
--     e.ENAME AS EmployeeName,
--     e.DEPNO AS DepartmentNumber,
--     e.SALARY AS MaxSalary
-- FROM 
--     EMPLOYEE e
-- INNER JOIN 
--     DEPARTMENT d ON e.DEPNO = d.DEPNO
-- INNER JOIN
--     (SELECT DEPNO, MAX(SALARY) AS MaxSalary FROM EMPLOYEE GROUP BY DEPNO) m
--     ON e.DEPNO = m.DEPNO AND e.SALARY = m.MaxSalary;

-- SELECT 
--     EMPID, ENAME, SALARY
-- FROM 
--     EMPLOYEE
-- WHERE 
--     SALARY <= (SELECT AVG(SALARY) FROM EMPLOYEE);

DESC EMPLOYEE;

SELECT
    EMPID, ENAME, SALARY
FROM 
    EMPLOYEE 
WHERE 
    SALARY < (SELECT MAX(SALARY) FROM EMPLOYEE);
